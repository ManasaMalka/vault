name: Sync GitHub Secrets to Vault
on:
  workflow_dispatch:

jobs:
  sync-secrets:
    runs-on: self-hosted
    steps:
      - name: Authenticate with Vault and Push Secrets
        env:
          VAULT_ADDR: http://127.0.0.1:8200
          VAULT_ROLE_ID: ${{ secrets.VAULT_ROLE_ID }}
          VAULT_SECRET_ID: ${{ secrets.VAULT_SECRET_ID }}
        shell: powershell
        run: |
          $env:VAULT_TOKEN = vault write -field=token auth/approle/login role_id=$env:VAULT_ROLE_ID secret_id=$env:VAULT_SECRET_ID
          
          vault kv patch "secret/myapps/qa-server-inspect/config" reports_folder="${{ secrets.reports_FOLDER }}"
          
          Write-Host "âœ… Successfully added images_folder to Vault!"
          vault kv get secret/myapps/qa-server-inspect/config


